#!/bin/sh

ROOT=$(dirname `(readlink -e $0)`)
name=$(basename $0)

load_path_directories=""

for i in $(find $ROOT/../app/solargraph $ROOT/../app/rubocop -maxdepth 1 -type d -regex '.*-[0-9.]+'); do
    load_path_directories+=" -I${i}/lib"
done

gem_folder=$(find $ROOT/../app/solargraph -maxdepth 1 -regex ".*/${name}-[0-9.]+" -type d)

exec -a $name /usr/bin/env ruby $load_path_directories $gem_folder/bin/$name "$@"
