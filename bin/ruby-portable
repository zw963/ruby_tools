#!/bin/sh

ROOT=$(dirname `(readlink -e $0)`)/..
# ROOT=$(realpath -L $ROOT)

load_path_directories="-I$ROOT/app/lib"

for i in $(find $ROOT/app/gems $ROOT/ruby/lib/ruby/gems/3.0.0/gems -maxdepth 1 -type d -regex '.*-[0-9]+\.[0-9]+\.[0-9]+'); do
    load_path_directories+=" -I${i}/lib"
done

exec -a ruby-portable /bin/bash $ROOT/ruby/bin/ruby -I$ROOT/app/lib $load_path_directories -rrbconfig "$@"
